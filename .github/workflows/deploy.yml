name: Deploy Frontend to Hugging Face

on:
  push:
    branches: [main]
    paths:
      - 'front/**' # front Ìè¥ÎçîÍ∞Ä Î≥ÄÍ≤ΩÎê† ÎïåÎßå Ïã§Ìñâ
  workflow_dispatch:

jobs:
  deploy-frontend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
          lfs: false 

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install Hugging Face Hub
        run: pip install huggingface_hub

      - name: Upload to Hugging Face Space
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
          HF_USERNAME: ${{ secrets.HF_USERNAME }}
        run: |
          python -c "
          from huggingface_hub import HfApi
          import os
          
          token = os.environ.get('HF_TOKEN')
          username = os.environ.get('HF_USERNAME')
          
          if not token or not username:
              raise ValueError('HF_TOKEN or HF_USERNAME secret is missing!')
              
          api = HfApi(token=token)
          
          repo_id = f'{username}/daitdanyang-frontend'
          print(f'üöÄ Deploying Frontend to: {repo_id}')
          
          try:
              api.upload_folder(
                  folder_path='./front',
                  repo_id=repo_id,
                  repo_type='space',
                  ignore_patterns=[
                      'node_modules/**', 'build/**', 'dist/**', '.git/**', '.cache/**', 'package-lock.json'
                  ],
                  commit_message='Deploy Frontend via GitHub Actions'
              )
              print('‚úÖ Frontend Upload Success!')
          except Exception as e:
              print(f'‚ùå Upload Failed: {e}')
              exit(1)
          "
